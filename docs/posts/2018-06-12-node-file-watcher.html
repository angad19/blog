<!DOCTYPE html>
<html>
  
  
  
  <head>
	<title>Nodejs file watcher</title>
	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Noto+Sans:700,400" rel="stylesheet">
	<link href="../assets/style.css" rel="stylesheet"/>
</head>

  <body>
    <div class="container-fluid main">
      <div class="full-post">
        <a href="../" class="back">&#8617; back</a>
        <h1>Nodejs file watcher</h1>
        <div class="info">Angad Singh | 2018-06-12 01:43</div>
        <div class="content">
          
<p>To see changes in the browser for this blog, I need to run the build script and refresh the browser manually. This can get tedious, so I decided to automate it.</p>

<p>This is pretty easy to do in Node, because Node was built for realtime things like this. The <code>fs</code> module has a <code>watch</code> function which can watch directories and do stuff when files change. I can just run the build script using <code>child_process.spawn</code>. Now I just need to find a way to reload the browser.</p>

<p>The easiest way I can think of doing that is with applescript. This snippet reloads the active chrome tab -<script src="https://gist.github.com/angad19/a2737a773827ad3c0c489411b375be3b.js"></script></p>

<p>Great! Now we can just run the <code>osascript -e</code> command to run this snippet.<script src="https://gist.github.com/angad19/885226238eea218ee06135d9cc542993.js"></script></p>

<p>All we have to do now is setup <code>fs.watch</code> to watch our directories. I decided to use <a href="https://github.com/paulmillr/chokidar">chokidar</a> to watch the files since it's kinda hard to watch subdirectories with <code>fs.watch</code>.</p>

<p>Here's the finished script - <script src="https://gist.github.com/angad19/96b8c2a987d0698be6fce3d3cc26093d.js"></script></p>

<p>Files beginning with <code>.#</code> are backup files created by Emacs, so we can ignore them. </p>
<p>The reload is kinda jerky but I don't mind it. I won't be looking at the browser constantly.</p>

        </div>
      </div>
      <footer>
  <a href="https://github.com/angad19" class="social" style="margin-left: 0;">github</a>
  <a href="https://open.spotify.com/user/angad5" class="social">spotify</a>
  <a href="mailto:angadsingh567890@gmail.com" class="social">mail</a>
  <a href="../feed.xml">RSS</a>
  <p>&copy; Angad Singh 2018</p>
</footer>

    </div>
  </body>
</html>
